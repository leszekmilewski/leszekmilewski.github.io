<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wojna – gra karciana</title>
  <style>
    body {
      font-family: 'Georgia', serif;
      background: #f9f9f9;
      color: #111;
      padding: 1rem;
      max-width: 900px;
      margin: auto;
    }

    h1 {
      text-align: center;
      font-size: 2rem;
    }

    #controls {
      text-align: center;
      margin: 1rem 0;
    }

    #log, #result {
      text-align: center;
      margin-top: 1.5rem;
      font-weight: bold;
    }

    .cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .player {
      text-align: center;
      flex: 1 1 120px;
      min-width: 100px;
    }

    .card {
      background: white;
      border: 1px solid #aaa;
      padding: 1rem;
      border-radius: 8px;
      font-size: 1.2rem;
      min-width: 60px;
      margin-bottom: 0.5rem;
    }

    .label {
      font-weight: bold;
      margin-top: 0.5rem;
    }

    @media (max-width: 600px) {
      .cards {
        flex-wrap: nowrap;
        overflow-x: auto;
      }

      .player {
        flex: 0 0 auto;
        min-width: 100px;
      }

      .card {
        font-size: 1rem;
        padding: 0.5rem;
      }
    }
  </style>
</head>
<body>

  <h1>Wojna – gra karciana</h1>

  <div id="controls">
    <label for="numOpponents">Wybierz liczbę przeciwników:</label>
    <select id="numOpponents">
      <option value="1">1 komputer</option>
      <option value="2">2 komputery</option>
      <option value="3">3 komputery</option>
    </select>
    <button onclick="startGame()">Rozpocznij grę</button>
    <button onclick="playRound()">Rozegraj turę</button>
  </div>

  <div id="rounds" style="text-align: center;"></div>

  <div class="cards" id="cardArea"></div>

  <div id="log"></div>
  <div id="result"></div>

  <script>
    const suits = ['♥', '♠', '♦', '♣'];
    const values = [
      { label: '2', power: 2 },
      { label: '3', power: 3 },
      { label: '4', power: 4 },
      { label: '5', power: 5 },
      { label: '6', power: 6 },
      { label: '7', power: 7 },
      { label: '8', power: 8 },
      { label: '9', power: 9 },
      { label: '10', power: 10 },
      { label: 'W', power: 11 },
      { label: 'D', power: 12 },
      { label: 'K', power: 13 },
      { label: 'A', power: 14 }
    ];

    let players = [];
    let round = 0;
    let draws = 0;

    function createDeck() {
      const deck = [];
      for (let suit of suits) {
        for (let v of values) {
          deck.push({ text: `${v.label}${suit}`, value: v.power });
        }
      }
      return deck;
    }

    function shuffle(deck) {
      for (let i = deck.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [deck[i], deck[j]] = [deck[j], deck[i]];
      }
      return deck;
    }

    function startGame() {
      const numOpponents = parseInt(document.getElementById('numOpponents').value);
      const deck = shuffle(createDeck());
      const totalPlayers = numOpponents + 1;
      players = Array.from({ length: totalPlayers }, () => []);
      deck.forEach((card, index) => {
        players[index % totalPlayers].push(card);
      });
      round = 0;
      draws = 0;
      updateCounts();
      document.getElementById('log').textContent = '';
      document.getElementById('result').textContent = '';
      document.getElementById('cardArea').innerHTML = '';
    }

    function playRound() {
      if (players.some(p => p.length === 0)) {
        document.getElementById('result').textContent = 'Gra zakończona!';
        return;
      }

      const revealed = players.map(p => p.shift());
      const maxVal = Math.max(...revealed.map(c => c.value));
      const winners = revealed.map(c => c.value === maxVal);
      const numWinners = winners.filter(Boolean).length;

      const pot = [...revealed];

      const cardArea = document.getElementById('cardArea');
      cardArea.innerHTML = '';

      for (let i = 0; i < revealed.length; i++) {
        const div = document.createElement('div');
        div.className = 'player';
        const cardDiv = document.createElement('div');
        cardDiv.className = 'card';
        cardDiv.textContent = revealed[i].text;
        div.appendChild(cardDiv);
        const label = document.createElement('div');
        label.className = 'label';
        label.textContent = i === 0 ? `Gracz (karty: ${players[i].length})` : `Komputer ${i} (karty: ${players[i].length})`;
        div.appendChild(label);
        cardArea.appendChild(div);
      }

      if (numWinners === 1) {
        const winnerIndex = winners.findIndex(Boolean);
        players[winnerIndex].push(...pot);
        document.getElementById('log').textContent = `Turę wygrywa ${winnerIndex === 0 ? 'Gracz' : 'Komputer ' + winnerIndex}.`;
      } else {
        draws++;
        document.getElementById('log').textContent = `Remis!`;
        // przy remisie: karty przepadają
      }

      round++;
      updateCounts();
    }

    function updateCounts() {
      document.getElementById('rounds').textContent = `Runda: ${round} | Remisów: ${draws}`;
    }
  </script>
</body>
</html>
