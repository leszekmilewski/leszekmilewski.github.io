<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gra w Wojnę</title>
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Libre Baskerville', serif;
      background-color: #fff;
      color: #111;
      max-width: 700px;
      margin: 0 auto;
      padding: 2rem;
      font-size: 17px;
      line-height: 1.7;
    }

    h1 {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 1.5rem;
    }

    #game {
      text-align: center;
    }

    .cards {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
      margin-bottom: 1rem;
    }

    .card {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 1rem;
      width: 80px;
      text-align: center;
      font-size: 1.2rem;
      background-color: #f8f8f8;
    }

    button {
      font-size: 1rem;
      padding: 0.5rem 1rem;
      margin-top: 1rem;
      cursor: pointer;
    }

    .status, .counts, .round {
      margin: 1rem 0;
    }

    .bold {
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Gra w Wojnę</h1>
  <div id="game">
    <div class="counts">
      🂠 Karty gracza: <span id="playerCount">26</span> &nbsp;&nbsp;&nbsp; 🂠 Karty komputera: <span id="computerCount">26</span>
    </div>
    <div class="round">
      🔁 Rozegrane rundy: <span id="roundCount">0</span>
    </div>
    <div class="cards" id="cardsArea"></div>
    <div class="status" id="statusText">Kliknij, by rozpocząć grę</div>
    <button onclick="playRound()">Zagraj turę</button>
  </div>

  <script>
    const suits = ['♠', '♥', '♦', '♣'];
    const faces = {
      11: 'Walet',
      12: 'Dama',
      13: 'Król',
      14: 'As'
    };

    function createDeck() {
      let deck = [];
      for (let suit of suits) {
        for (let value = 2; value <= 14; value++) {
          deck.push({ value, text: (faces[value] || value) + ' ' + suit });
        }
      }
      return deck;
    }

    function shuffle(deck) {
      for (let i = deck.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [deck[i], deck[j]] = [deck[j], deck[i]];
      }
      return deck;
    }

    let fullDeck = shuffle(createDeck());
    let playerDeck = fullDeck.slice(0, 26);
    let computerDeck = fullDeck.slice(26);
    let pot = [];
    let roundCount = 0;

    function updateUI(status) {
      document.getElementById("playerCount").textContent = playerDeck.length;
      document.getElementById("computerCount").textContent = computerDeck.length;
      document.getElementById("roundCount").textContent = roundCount;
      document.getElementById("statusText").textContent = status;
    }

    function renderCards(cards, highlight = false) {
      const area = document.getElementById("cardsArea");
      area.innerHTML = '';
      cards.forEach(card => {
        const div = document.createElement("div");
        div.className = "card";
        if (highlight) div.classList.add("bold");
        div.textContent = card.text;
        area.appendChild(div);
      });
    }

    function playRound() {
      if (playerDeck.length === 0 || computerDeck.length === 0) {
        const winner = playerDeck.length > 0 ? "Gracz wygrywa grę!" : "Komputer wygrywa grę!";
        updateUI(winner);
        return;
      }

      roundCount++;
      const playerCard = playerDeck.shift();
      const computerCard = computerDeck.shift();

      pot.push(playerCard, computerCard);

      renderCards([playerCard, computerCard]);

      if (playerCard.value > computerCard.value) {
        playerDeck.push(...pot);
        pot = [];
        updateUI("Gracz wygrywa rundę.");
      } else if (playerCard.value < computerCard.value) {
        computerDeck.push(...pot);
        pot = [];
        updateUI("Komputer wygrywa rundę.");
      } else {
        updateUI("Remis! Każdy kładzie 3 karty...");
        handleWar();
      }
    }

    function handleWar() {
      let warCards = [];

      for (let i = 0; i < 3; i++) {
        if (playerDeck.length > 0) warCards.push(playerDeck.shift());
        if (computerDeck.length > 0) warCards.push(computerDeck.shift());
      }

      if (playerDeck.length === 0 || computerDeck.length === 0) {
        updateUI("Brak kart do kontynuowania wojny!");
        return;
      }

      const playerWarCard = playerDeck.shift();
      const computerWarCard = computerDeck.shift();

      pot.push(...warCards, playerWarCard, computerWarCard);

      renderCards(pot);

      if (playerWarCard.value > computerWarCard.value) {
        playerDeck.push(...pot);
        pot = [];
        updateUI("Gracz wygrywa wojnę!");
      } else if (playerWarCard.value < computerWarCard.value) {
        computerDeck.push(...pot);
        pot = [];
        updateUI("Komputer wygrywa wojnę!");
      } else {
        updateUI("Kolejny remis podczas wojny! Kontynuujemy...");
        setTimeout(handleWar, 1000); // Kontynuuj wojnę po krótkiej pauzie
      }
    }

    updateUI("Gotowy do gry.");
  </script>
</body>
</html>
